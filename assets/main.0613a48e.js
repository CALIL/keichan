var e=Object.defineProperty,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,l=(e,l)=>{for(var i in l||(l={}))s.call(l,i)&&n(e,i,l[i]);if(t)for(var i of t(l))a.call(l,i)&&n(e,i,l[i]);return e},i=(e,t,s)=>(n(e,"symbol"!=typeof t?t+"":t,s),s);import("data:text/javascript;base64,Cg==");import{r,J as o,R as c,C as u,E as p,T as m,a as h,I as d,u as b,l as v,s as g,h as f,O as E,b as y,S as w,B as k,F as x,c as N,X as S,d as C,e as z}from"./vendor.9cd849c1.js";const O=e=>{const t=e.book,s=r.exports.useRef(null);return r.exports.useEffect((()=>{o(s.current,t.isbn,{format:"codabar",width:1.25,height:26,margin:10,fontSize:12})}),[]),c.createElement(u,{key:t.isbn,className:"card",interactive:!0,elevation:p.TWO},c.createElement("div",{className:"card-header"},t.cover?c.createElement("img",{src:t.cover,alt:t.title}):null,c.createElement("div",null,c.createElement("h3",null,[t.title,t.volume].join(" ")),c.createElement("p",{className:"author"},t.author),t.tags.map((e=>c.createElement(m,{key:e},e))))),c.createElement("svg",{ref:s,xmlns:"http://www.w3.org/2000/svg",version:"1.1"}))};class V extends r.exports.Component{constructor(){super(),this.state={}}render(){return c.createElement("div",{className:"book",onClick:()=>this.props.open(this.props.book)},this.props.book.isbn&&(this.props.count<10*this.props.updateCount||this.props.completed)?c.createElement("img",{src:`https://calil.jp/cover/${this.props.book.isbn}`}):c.createElement("div",{className:"no_book_cover"}),c.createElement("div",null,c.createElement("div",{className:"title"},this.props.book.title),c.createElement("div",{className:"author"},this.props.book.author)))}}const T=["free","title","author","publisher","isbn","ndc","year_start","year_end","region"];function I(e){return h.get("https://unitrad.calil.jp/v1/"+e)}class D{constructor(e,t){i(this,"callback"),i(this,"killed"),i(this,"data"),this.callback=t,this.killed=!1,this.search(e)}kill(){this.killed=!0}search(e){this.killed||I("search").query(function(e){let t={};for(let s of T)e.hasOwnProperty(s)&&""!==e[s]&&(t[s]=e[s]);return t}(e)).end(((t,s)=>{t?setTimeout((()=>this.search(e)),1e3):this.receive(s.body)}))}polling(){this.killed||I("polling").query({uuid:this.data.uuid,version:this.data.version,diff:1,timeout:10}).end(((e,t)=>{null===t.body?setTimeout((()=>this.polling()),100):this.receive(t.body)}))}receive(e){if(!this.killed){if(e.books_diff){Array.prototype.push.apply(this.data.books,e.books_diff.insert);for(let t in e)e.hasOwnProperty(t)&&"books_diff"!==t&&(this.data[t]=e[t]);for(let t of e.books_diff.update)for(let e in t)if(t.hasOwnProperty(e)&&"_idx"!==e)if(!0===Array.isArray(t[e]))Array.prototype.push.apply(this.data.books[t._idx][e],t[e]);else if(t[e]instanceof Object)for(let s in t[e])t[e].hasOwnProperty(s)&&(this.data.books[t._idx][e][s]=t[e][s]);else this.data.books[t._idx][e]=t[e]}else this.data=e;this.callback(this.data),!0===e.running?(console.log("[Unitrad] continue..."),1===e.version&&0===this.data.books.length?setTimeout((()=>this.polling()),20):setTimeout((()=>this.polling()),500)):console.log("[Unitrad] complete.")}}}class j extends r.exports.Component{constructor(e){super(e),this.api=null,this.prevQuery="",this.state={loading:!1,running:!1,books:[],message:"",hint:"",updateCount:0}}kill(){this.api&&(this.api.kill(),this.setState({updateCount:0,running:!1}))}componentDidMount(){this.props.query===this.prevQuery&&(this.state.showResult=!0),""!=this.props.query&&this.props.query!=this.prevQuery&&(this.kill(),this.prevQuery=this.props.query,this.api=new D({free:this.props.query,region:this.props.region},(e=>{let t=[];e.books.slice(0,300).map((e=>{if(e.isbn&&e.isbn.length>=10){const s=d.parse(e.isbn);e.isbn=s?s.asIsbn13():e.isbn.replace(/-/g,""),t.push(e)}else e.isbn=void 0,t.push(e)}));let s=e.running;t.length>20&&(s=!1,this.kill()),this.setState({books:t,loading:s&&t.length<10,running:s,notFound:!1===s&&0===t.length,updateCount:this.state.updateCount+1,showResult:!0})})))}componentDidUpdate(){this.componentDidMount()}componentWillUnmount(){this.kill()}render(){let e=0;return c.createElement("div",{className:"suggest"},this.state.books.length>0?c.createElement("div",{className:"results"},this.state.books.map((t=>(e+=1,c.createElement(V,{book:t,key:t.id,count:e,updateCount:this.state.updateCount,completed:!this.state.running,open:e=>{this.props.open(e)}}))))):this.state.running?c.createElement("div",{className:"message"},"検索中..."):null,this.state.notFound?c.createElement("div",{className:"message"},"見つかりませんでした"):null)}}function B(e){e=b.nfkc(e).toUpperCase().replace(/[^0-9X]/g,"");let t=v.parse(e);if(t){if(t.isIsbn10())return t.asIsbn10();if(t.isIsbn13()){return t.asIsbn13().startsWith("978")?t.asIsbn10():t.asIsbn13()}}else{let t=v.parse("978"+e);if(t&&t.isIsbn13())return t.asIsbn10()}return!1}const _=async e=>{const t=e.author.split(",")[0],s=e.publisher,a=e.pubdate;return new Promise((async(n,l)=>{let i=new D({author:t,publisher:s,year_start:a,region:"recipe"},(async t=>{if(!i.killed&&(t.count>5&&i.kill(),console.log(t),t.count>=1)){const s=[];t.books.forEach((e=>{if(null===e.isbn)return;let t=0;e.pubdate&&(t="string"!=typeof e.pubdate?e.pubdate:Number(e.pubdate.split("/")[0].split(".")[0]));let a=v.parse(B(e.isbn)),n=null;a&&(n=a.asIsbn13()),n&&s.push({title:e.title+" "+e.volume,author:e.author.split(",")[0],publisher:e.publisher,isbn:n,pubdate:t,source:"unitrad"})})),s.sort((function(e,t){return e.isbn<t.isbn?-1:e.isbn>t.isbn?1:0}));let a=[];const l=[];let i=!1;s.forEach((t=>{t.isbn!==e.isbn&&(i?a.push(t):l.push(t)),t.isbn===e.isbn&&(i=!0)})),a=a.concat(l);const r=[];a.forEach((e=>{r.push(e.isbn)}));const o=await H(r);n(o)}}))}))},H=async e=>new Promise((async(t,s)=>{const a=await fetch("https://api.openBD.jp/v1/get?isbn="+e.join(",")).then((e=>e.json())),n=[];a.forEach((e=>{if(e){const t=[];try{e.onix.DescriptiveDetail.Collection.TitleDetail.TitleElement.forEach(((e,s)=>{t.includes(e.TitleText.content)||t.push(e.TitleText.content)}))}catch{}let s=e.summary.volume;try{""===s&&(s=e.onix.DescriptiveDetail.TitleDetail.TitleElement.PartNumber.split(";")[0],e.summary.title.match(s)&&(s=""))}catch{}let a="";try{e.onix.ProductSupply.SupplyDetail.Price.some((e=>{"JPY"===e.CurrencyCode&&(a=e.PriceAmount)}))}catch{}let l="";try{e.onix.DescriptiveDetail.Subject.some((e=>{"78"===e.SubjectSchemeIdentifier&&(l=e.SubjectCode)}))}catch{}const i={title:[e.summary.title,s].join(" "),author:e.summary.author,publisher:e.summary.publisher,isbn:e.summary.isbn,pubdate:e.summary.pubdate,cover:e.summary.cover,tags:t,price:a,cCode:l,source:"opendBD"};i.bibHash=$(i),n.push(i)}})),t(n)})),$=e=>g(e.id+e.title+e.author+e.publisher+e.isbn);let A=new f.Howl({src:["./audio/safety.mp3"],autoplay:!1,loop:!1,volume:1,onend:function(){console.log("Finished!")}}),R=new f.Howl({src:["./audio/error.mp3"],autoplay:!1,loop:!1,volume:.7,onend:function(){console.log("Finished!")}});let P="",F=null,L=null;const q=e=>{if("speechSynthesis"in window){const t=new SpeechSynthesisUtterance(e);t.rate=1.5,speechSynthesis.speak(t)}},U=()=>{const[e,t]=r.exports.useState("gk-xxxxxxxxxxxxxxx");let s=[],a="isbn";const n=localStorage.getItem("keichanData_"+e);if(n){const e=JSON.parse(n);e.rowList.map((e=>{void 0===e.pubdate&&(e.pubdate=""),void 0===e.source&&(e.source="openBD")})),s=e.rowList,a=e.mode}const[i,o]=r.exports.useState(s),[h,d]=r.exports.useState(a),b=[];0===i.length||i[i.length-1].title?"isbn"===h?b.push("バーコードをスキャンしてください"):b.push("資料コードのバーコードをスキャンしてください"):b.push("紐つけるバーコードをスキャンしてください");const[g,f]=r.exports.useState(b),[z,V]=r.exports.useState([]),[T,I]=r.exports.useState(""),[U,J]=r.exports.useState({title:"",author:"",publisher:"",pubdate:"",isbn:""}),[M,W]=r.exports.useState(!0),[Z,Q]=r.exports.useState(!0),[X,Y]=r.exports.useState(!1),[K,G]=r.exports.useState(!1),[ee,te]=r.exports.useState(!1),[se,ae]=r.exports.useState({show:!1,message:""});r.exports.useEffect((()=>{localStorage.setItem("keichanData_"+e,JSON.stringify({mode:h,rowList:i}))}),[i,h]);const ne=e=>((e,t)=>{if(console.log("onKeyDown"),e.target.closest(".addMore"))return;const s=(new Date).getTime(),a=s-L;L=s;const n=e||window.event,l=n.keyCode||n.which||n.charCode;"Enter"===e.key||13===l?(a<100&&t(P),F&&clearTimeout(F),P=""):(1===e.key.length?P+=e.key:"Shift"===e.key||(P=""),F&&clearTimeout(F),F=setTimeout((()=>{a<100&&t(P),P=""}),300))})(e,oe);r.exports.useEffect((()=>(window.addEventListener("keydown",ne),()=>{window.removeEventListener("keydown",ne)})),[h,i,M,g,Z]),r.exports.useEffect((()=>{document.body.addEventListener("click",(e=>{te(!1)}))}),[!0]);const le=(e,t=null)=>{ae({show:!0,message:e.replace("!! ","")}),f([...g,c.createElement(c.Fragment,null,t?c.createElement("div",null,c.createElement("span",{style:{fontFamily:'"Conv_OCRB", Sans-Serif'}},t)):null,c.createElement("div",null,e.match(/!!/)?c.createElement("span",{style:{color:"red"}},"!! "):null,c.createElement("span",null,e.replace("!! ",""))))])},ie=async(e,t)=>{const s=[];if(s.push("ISBNのバーコードが読まれました"),s.push(c.createElement("span",{style:{fontFamily:'"Conv_OCRB", Sans-Serif'}},e)),V([]),e.match(/^[a-zA-Z](\d+)[a-zA-Z]$/)&&(e=RegExp.$1,s.push("codabarの制御コードを検出しました")),"management"===h&&0===i.length)return le("!! 資料コードを読んでください"),void R.play();if("isbn"===h&&i.filter((t=>t.id===e)).length>0)return le("!! すでに登録済みの資料です"),void R.play();if("management"===h&&i.length>0){const e=[...i],s=e[e.length-1];if(!s||s.isbn)return le("次は資料コードのバーコードを読んでください"),void R.play();{let a=v.parse(t);a&&(s.isbn=a.asIsbn13()),o(e)}}A.play(),G(!0);const a=await(async e=>new Promise((async(t,s)=>{const a=new D({isbn:e,region:"recipe"},(async e=>{if(e.count>=1){a.kill();const s=e.books[0],n={id:s.id,title:s.title,author:s.author,publisher:s.publisher,pubdate:s.pubdate,isbn:s.isbn,tags:[],price:"",cCode:"",source:"unitrad"};n.bibHash=$(n);let l=v.parse(B(n.isbn));l&&(n.isbn=l.asIsbn13());const i=await H([n.isbn]);i.length>0?(i[0].id=n.id,t(i[0])):t(n)}else!1===e.running&&0===e.count&&s()}))})))(t).catch((()=>(e=>{const t=[...i];t.forEach(((t,s)=>{B(t.isbn)===e&&(t.title="",t.author="",t.publisher="",t.pubdate="",t.isbn="",t.cover="",t.tags=[],t.bibHash="",t.price="",t.cCode="",t.source="")})),o(t),R.play(),le("!! 本が見つかりませんでした。書誌データは追加されません")})(t)));if(G(!1),a)if(s.push("本が見つかりました！"),"isbn"===h){a.id=a.isbn,o([...i,a]),Z?q(`${a.title}を追加`):s.push(`「${a.title}」を追加`);const e=i[i.length-1];if(e&&e.title){s.push(`一つ前の本、「${e.title}」から次の本の候補を探します`);const t=await _(e);V(t),t.length>0&&s.push(`候補の本が${t.length}冊みつかりました`)}}else if("management"===h){const e=[...i];e.forEach(((e,s)=>{B(e.isbn)===t&&(e.title=a.title,e.author=a.author,e.publisher=a.publisher,e.pubdate=a.pubdate,e.cover=a.cover,e.isbn=a.isbn,e.tags=a.tags,e.bibHash=a.bibHash,e.price=a.price,e.cCode=a.cCode,e.source=a.source)})),o(e),Z&&q(`${a.title}を追加`)}f([...g,...s])},re=async e=>{if(!1===(e=>e.length>20?(le("資料コードが長すぎます。バーコードの連続読み取りと判断して、処理しません",e),R.play(),!1):null!==e.match(/^192/)?(le("192で始まるバーコードのため、書籍JANコード(下段)と判断して、処理しません",e),R.play(),!1):null!==e.match(/^491/)?(le("491で始まるバーコードのため、雑誌コードと判断して、処理しません",e),R.play(),!1):null===e.match(/[a-zA-Z0-9]+/)?(b.push("英数字以外のキーが入力されました。処理しません"),f([...g,...b]),!1):!e.match(/^[a-zA-Z]*$/)||(b.push("英字のみが入力されました。処理しません"),f([...g,...b]),!1))(e))return;e.match(/^[a-zA-Z](\d+)[a-zA-Z]$/)&&(e=RegExp.$1,b.push("codabarの制御コードを検出しました")),"isbn"===h&&(d("management"),b.push("資料コードが読み込まれたため、資料コード用のモードに切り替えます")),b.push(c.createElement("span",{style:{fontFamily:'"Conv_OCRB", Sans-Serif'}},e));const t=i[i.length-1];if(i.filter((t=>t.id===e)).length>0)return le("!! すでに登録済みの資料コードです"),void R.play();if(A.play(),o([...i,{id:e}]),t&&t.title){b.push(`一つ前の本、「${t.title}」から次の本の候補を探します`);const e=await _(t);V(e),e.length>0&&b.push(`候補の本が${e.length}冊みつかりました`)}f([...g,...b])},oe=async e=>{if(!1===M)return;const t=B(e);t?ie(e,t):re(e),W(!1),setTimeout((()=>W(!0)),100)},ce=e=>{if(""===U.title)return le("タイトルは必須です"),R.play(),!1;const t=[...i],s=t[t.length-1];s.title=U.title,s.author=U.author,s.publisher=U.publisher,s.pubdate=U.pubdate,s.cover=""!==U.isbn?"https://calil.jp/cover/"+U.isbn:"",s.isbn=U.isbn,s.tags=[],s.bibHash=$(l(l({},s),U)),s.price="",s.cCode="",s.source="user",o(t),Z&&q(`${s.title}を追加`)},ue=r.exports.useRef(null);let pe;r.exports.useEffect((()=>{if(ue.current){const e=ue.current;e.scrollTop=e.scrollHeight}}),[g]),r.exports.useEffect((()=>{pe&&clearTimeout(pe),pe=setTimeout((()=>{ae({show:!1,message:""})}),6e3)}),[se]);const me=r.exports.useRef(null);return r.exports.useEffect((()=>{const e=setInterval((()=>{me.current&&(me.current.style.display="none",setTimeout((()=>{me.current.style.display="inline"}),500))}),1e3);return()=>{clearInterval(e)}}),[!0]),c.createElement("div",{id:"index"},c.createElement(E,{isOpen:se.show,onClose:()=>ae({show:!1,message:""}),hasBackdrop:!1},c.createElement("div",{className:"bp3-card bp3-elevation-4 bp3-overlay-content alert-message"},c.createElement(y,{icon:"tick",size:25,color:"#000000"}),se.message)),c.createElement(E,{isOpen:X,onClose:()=>Y(!1),hasBackdrop:!0},c.createElement("div",{className:"bp3-card bp3-elevation-4 bp3-overlay-content settings-overlay"},c.createElement("div",{className:"settings"},c.createElement("h3",null,"設定"),"speechSynthesis"in window?c.createElement(w,{checked:Z,label:"読み上げ",onChange:()=>Q(!Z)}):null,c.createElement("br",null),c.createElement("hr",null),c.createElement("br",null),i.length>0?c.createElement(k,{icon:"download",onClick:()=>((e,t)=>{const s=new Date;t+=`_${s.getFullYear()}${s.getMonth()+1}${s.getDate()}.json`;const a=new Blob([JSON.stringify(e,null,"  ")],{type:"application/json"}),n=URL.createObjectURL(a),l=document.createElement("a");l.href=n,l.download=t,l.click(),URL.revokeObjectURL(n)})({mode:h,rowList:i},"keichanData_"+e),style:{marginRight:"0.5rem"}},"JSONで保存"):null,c.createElement(k,{icon:"upload",onClick:()=>{document.querySelector('input[type="file"]').click()}},"JSONを読み込み"),c.createElement("input",{type:"file",accept:"application/json",onChange:e=>{for(var t,s=e.target.files,a=0;t=s[a];a++){if(!t.type.match("application/json"))continue;const e=new FileReader;e.onload=e=>{const t=JSON.parse(e.target.result);if(void 0===t.rowList||void 0===t.mode)return le("JSONファイルの形式が異なっています"),void R.play();t.rowList.map((e=>{void 0===e.pubdate&&(e.pubdate=""),void 0===e.source&&(e.source="openBD")})),o(t.rowList),d(t.mode)},e.readAsText(t)}},style:{display:"none"}}),c.createElement("br",null),c.createElement("br",null),c.createElement(k,{icon:"cross",onClick:()=>Y(!1)},"閉じる")))),c.createElement("header",null,c.createElement("div",null),c.createElement("h1",null,"カーリルtoolbox: keichan"),c.createElement("div",null,c.createElement("label",{htmlFor:""},"モード:"),c.createElement("span",{className:"modes"},c.createElement("span",{className:"mode isbn"+("isbn"===h?" active":""),onClick:()=>{d("isbn"),f([...g,"モードをISBNに変更しました","バーコードをスキャンしてください"])}},"ISBN"),c.createElement("span",{className:"mode management"+("management"===h?" active":""),onClick:()=>{d("management"),f([...g,"モードを資料コードに変更しました","資料コードのバーコードをスキャンしてください"])}},"資料コード")),i.length>0?c.createElement(k,{icon:"download",onClick:()=>((e,t)=>{const s=S.utils.book_new();s.Props={Title:"",Subject:"",Author:"",CreatedDate:new Date},s.SheetNames.push("蔵書データ");const a=[];a.push(["id","タイトル","著者","出版社","発売日","ISBN","タグ","価格","Cコード"]),e.map((e=>{e.isbn&&a.push([e.id,e.title,e.author,e.publisher,e.pubdate,e.isbn,e.tags.join(","),e.price,e.cCode])}));const n=S.utils.aoa_to_sheet(a);s.Sheets["蔵書データ"]=n;const l=S.write(s,{bookType:"xlsx",type:"binary"});C.exports.saveAs(new Blob([function(e){const t=new ArrayBuffer(e.length),s=new Uint8Array(t);for(let a=0;a<e.length;a++)s[a]=255&e.charCodeAt(a);return t}(l)],{type:"application/octet-stream"}),t+".xlsx")})(i,e)},"Excelで保存"):null,c.createElement(k,{className:"settingsButton",icon:"cog",onClick:()=>Y(!0)},"設定"))),c.createElement("main",null,c.createElement("div",{className:"main"},0===i.length?c.createElement("div",{className:"description"},c.createElement("div",null,c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},c.createElement("path",{d:"M0 448V64h18v384H0zm26.857-.273V64H36v383.727h-9.143zm27.143 0V64h8.857v383.727H54zm44.857 0V64h8.857v383.727h-8.857zm36 0V64h17.714v383.727h-17.714zm44.857 0V64h8.857v383.727h-8.857zm18 0V64h8.857v383.727h-8.857zm18 0V64h8.857v383.727h-8.857zm35.715 0V64h18v383.727h-18zm44.857 0V64h18v383.727h-18zm35.999 0V64h18.001v383.727h-18.001zm36.001 0V64h18.001v383.727h-18.001zm26.857 0V64h18v383.727h-18zm45.143 0V64h26.857v383.727h-26.857zm35.714 0V64h9.143v383.727H476zm18 .273V64h18v384h-18z"})),"isbn"===h?"バーコードをスキャンしてください":"資料コードのバーコードをスキャンしてください")):null,i.slice().reverse().map(((e,t)=>c.createElement("div",{key:"row"+t},c.createElement(u,{key:"managementCode",className:"card active",interactive:!1,elevation:p.TWO},c.createElement("span",{className:"document"},c.createElement("span",{className:"documentHeader"},"資料コード"),c.createElement("span",{className:"documentCode"},e.id)),c.createElement(y,{icon:"delete",size:25,color:"#ffffff",onClick:()=>{return t=e.id,void o(i.filter((e=>e.id!==t)));var t}})),c.createElement("div",{className:"linkedData"},e.isbn?c.createElement(u,{key:e.bibHash+e.isbn,className:"card indent",interactive:!1,elevation:p.TWO},c.createElement("div",{className:"flex"},c.createElement("span",{className:"isbn"},c.createElement("span",{className:"isbnHeader"},"ISBN"),c.createElement("span",{className:"isbnCode"},e.isbn)))):null,e.title?c.createElement(u,{key:e.bibHash,className:"card indent",interactive:!1,elevation:p.TWO},c.createElement("div",{className:"flex"},e.cover?c.createElement("img",{className:"thumbnail",src:e.cover,alt:""}):null,c.createElement("div",null,c.createElement("h3",null,e.title),c.createElement("p",{className:"author"},e.author),e.tags.map((e=>c.createElement(m,{key:e},e)))))):null,void 0===e.title&&K?c.createElement(u,{className:"card indent",style:{height:"120px"},interactive:!1,elevation:p.TWO},c.createElement("div",{className:"placeholder"},c.createElement("div",{className:"placeholder-line title"}),c.createElement("div",{className:"placeholder-line"}),c.createElement("div",{className:"placeholder-line"}),c.createElement("div",{className:"placeholder-line"}),c.createElement("div",{className:"placeholder-line"}))):null),"management"===h&&void 0===e.isbn?c.createElement(c.Fragment,null,c.createElement("div",{className:"description"},c.createElement("div",null,c.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},c.createElement("path",{d:"M0 448V64h18v384H0zm26.857-.273V64H36v383.727h-9.143zm27.143 0V64h8.857v383.727H54zm44.857 0V64h8.857v383.727h-8.857zm36 0V64h17.714v383.727h-17.714zm44.857 0V64h8.857v383.727h-8.857zm18 0V64h8.857v383.727h-8.857zm18 0V64h8.857v383.727h-8.857zm35.715 0V64h18v383.727h-18zm44.857 0V64h18v383.727h-18zm35.999 0V64h18.001v383.727h-18.001zm36.001 0V64h18.001v383.727h-18.001zm26.857 0V64h18v383.727h-18zm45.143 0V64h26.857v383.727h-26.857zm35.714 0V64h9.143v383.727H476zm18 .273V64h18v384h-18z"})),"紐つけるバーコードをスキャンしてください")),i.length>1&&z.length>0?c.createElement("div",{className:"nextBook"},c.createElement("h2",null,"もしかして",c.createElement("span",null,"(",i[i.length-2].title,"より推定)")),c.createElement("div",{className:"cards"},z.slice(0,5).map((e=>c.createElement(O,{book:e,key:e.isbn}))))):null,c.createElement("div",{className:"addMore"},c.createElement("h3",null,"本を入力して追加"),c.createElement("form",{action:"",onSubmit:e=>{e.preventDefault();const t=e.target.querySelector("input");I(t.value),te(!0);var s=t.getBoundingClientRect();s.top,window.pageYOffset;var a=s.left+window.pageXOffset,n=s.bottom+window.pageYOffset;s.right,window.pageXOffset;const l=document.querySelector(".suggest");l.style.top=`${n}px`,l.style.left=`${a}px`,l.style.width=s.right-s.left+"px"}},c.createElement("div",{className:"bp3-input-group modifier"},c.createElement("span",{className:"bp3-icon bp3-icon-search"}),c.createElement("input",{className:"bp3-input",type:"search",placeholder:"キーワード or ISBNで探す",dir:"auto"}))),c.createElement("div",{className:ee?"show_suggest":"hide_suggest"},c.createElement(j,{region:"recipe",open:e=>{let t="";e.pubdate&&(t="string"!=typeof e.pubdate?e.pubdate:e.pubdate.replace(/[^0-9０-９]+/,"")),J({title:e.title,author:e.author,publisher:e.publisher,pubdate:t.toString(),isbn:e.isbn})},query:T})),c.createElement(x,{helperText:"",label:"書誌情報を自分で入力",labelFor:"text-input",labelInfo:""},c.createElement(N,{className:"title",small:!0,placeholder:"タイトル",value:U.title}),c.createElement(N,{className:"author",small:!0,placeholder:"著者名",value:U.author}),c.createElement(N,{className:"publisher",small:!0,placeholder:"出版社",value:U.publisher}),c.createElement(N,{className:"pubdate",small:!0,placeholder:"出版日(20211010)",value:U.pubdate}),c.createElement(N,{className:"isbn",small:!0,placeholder:"ISBN",value:U.isbn}),c.createElement(k,{icon:"plus",onClick:ce},"追加")))):null)))),c.createElement("div",{className:"debug"},c.createElement("div",{className:"logs",ref:ue},g.map(((e,t)=>c.createElement("div",{key:"log"+t},e)))),c.createElement("div",{className:"cmd"},"> ",c.createElement("span",{ref:me},"_")))))};z.render(c.createElement(U,null),document.getElementById("app"));
