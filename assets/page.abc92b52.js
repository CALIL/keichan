import("data:text/javascript;base64,Cg==");import{n as e,a as t}from"./api.462ba066.js";import{r as a,l as n,R as l,T as s,C as c,E as r,c as i,a as m}from"./vendor.de6f6c87.js";let o="",u=null;const d=m=>{const[d,E]=a.exports.useState([]),[p,h]=a.exports.useState(null),[b,v]=a.exports.useState([]);a.exports.useState("gk-xxxxxxxxxxxxxxx");const[x,f]=a.exports.useState("isbn");a.exports.useEffect((()=>{window.document.addEventListener("keydown",(e=>((e,t)=>{const a=e||window.event,n=a.keyCode||a.which||a.charCode;"Enter"===e.key||13===n?(t(o),u&&clearTimeout(u),o=""):(1===e.key.length?o+=e.key:"Shift"===e.key||(o=""),u&&clearTimeout(u),u=setTimeout((()=>{t(o),o=""}),300))})(e,g)))}),[]);const g=async t=>{const a=e(t);if(a){const e=await y(a);e&&"isbn"===x&&(e.id=e.isbn,E([...d,e]))}else{if(null!==t.match(/^192/))return;f("management"),E([...d,{id:t}])}},y=async a=>(h(null),v([]),new Promise((async(l,s)=>{const c=new t({isbn:a,region:"recipe"},(async t=>{if(t.count>=1){c.kill();const a=t.books[0],s={id:a.id,title:a.title,author:a.author,publisher:a.publisher,pubdate:a.pubdate,isbn:a.isbn,tags:[]};let r=n.parse(e(s.isbn));s.isbn=r.asIsbn13();const i=await N(s.isbn);null!==i[0]?l(i[0]):l(s)}else!1===t.running&&0===t.count&&s()}))}))),N=async e=>new Promise((async(t,a)=>{const n=await fetch("https://api.openBD.jp/v1/get?isbn="+e.join(",")).then((e=>e.json()));console.log(n);const l=[];n.forEach((e=>{if(e){const t=[];try{e.onix.DescriptiveDetail.Collection.TitleDetail.TitleElement.forEach(((e,a)=>{t.includes(e.TitleText.content)||t.push(e.TitleText.content)}))}catch{}let a=e.summary.volume;try{""===a&&(a=e.onix.DescriptiveDetail.TitleDetail.TitleElement.PartNumber)}catch{}const n={title:[e.summary.title,a].join(" "),author:e.summary.author,publisher:e.summary.publisher,isbn:e.summary.isbn,pubdate:e.summary.pubdate,cover:e.summary.cover,tags:t};l.push(n)}})),t(l)}));return l.createElement("div",{id:"new"},l.createElement("header",null,l.createElement("h1",null,"カーリルtoolbox: keichan","management"===x?l.createElement("span",{className:"mode"},"資料コード"):null)),l.createElement("main",null,l.createElement("div",{className:"left"},l.createElement("div",{className:"barcode active"},l.createElement(s,{large:!0,className:"tag"},"100014")),l.createElement("div",{className:"barcode"},l.createElement(s,{large:!0,className:"tag"},"100013"),l.createElement("p",null,"SPY×FAMILY 1")),l.createElement("div",{className:"barcode"},l.createElement(s,{large:!0,className:"tag"},"100012"),l.createElement("p",null,"1Q84 Book2"))),l.createElement("div",{className:"main"},l.createElement(c,{className:"card active",interactive:!0,elevation:r.TWO},l.createElement("div",null,l.createElement(s,{className:"tag",large:!0},"100014"),l.createElement(s,{className:"tag"},"管理バーコード")),l.createElement(i,{icon:"delete",size:25,color:"#ffffff"})),p&&b.length>0?l.createElement("div",{className:"nextBook"},l.createElement("h2",null,"もしかして",l.createElement("span",null,"(",p.title+""+p.volume,"より推定)")),l.createElement("div",{className:"cards"},b.map((e=>l.createElement(c,{key:e.isbn,className:"card",interactive:!0,elevation:r.TWO},l.createElement("div",{className:"card-header"},e.cover?l.createElement("img",{src:e.cover,alt:e.title}):null,l.createElement("div",null,l.createElement("h3",null,[e.title,e.volume].join(" ")),l.createElement("p",{className:"author"},e.author),e.tags.map((e=>l.createElement(s,null,e))),l.createElement("p",null,e.isbn))),l.createElement(i,{icon:"add",size:25,color:"#ffffff"})))))):null)))};m.render(l.createElement(d,null),document.getElementById("app"));
