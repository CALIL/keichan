import("data:text/javascript;base64,Cg==");import{n as e}from"./normalize_isbn.2e27dccc.js";import{r as t,R as a,T as n,C as l,E as c,c as s,b as r}from"./vendor.8dec45df.js";const o=r=>{let o="",i=null;const[m,d]=t.exports.useState(null),[u,E]=t.exports.useState([]);t.exports.useEffect((()=>{window.document.addEventListener("keydown",p)}),[]),t.exports.useEffect((()=>{window.document.addEventListener("keydown",p)}),[]);const p=e=>{const t=e||window.event,a=t.keyCode||t.which||t.charCode;"Enter"===e.key||13===a?(f(),i&&clearTimeout(i),o=""):(1===e.key.length?o+=e.key:"Shift"===e.key||(o=""),i&&clearTimeout(i),i=setTimeout((()=>{console.log("clear"),f(),o=""}),300))},f=async()=>{const t=e(o);if(t){const e=await h(t);e&&(d(e),await v(e))}},h=async e=>{d(null),E([]);const t=await fetch(`https://unitrad.calil.jp/v1/search?isbn=${e}&region=recipe`).then((e=>e.json()));return t.count>=1?t.books[0]:null},v=async e=>{e.title.split(/\s/)[0];const t=`https://unitrad.calil.jp/v1/search?author=${encodeURIComponent(e.author.split(",")[0])}&publisher=${encodeURIComponent(e.publisher)}&year_start=${encodeURIComponent(e.pubdate)}&region=recipe`,a=await fetch(t).then((e=>e.json()));if(a.count>=1){const t=a.books.filter((t=>t.isbn!==e.isbn));E(t)}};return a.createElement("div",{id:"suggests"},a.createElement("header",null,a.createElement("h1",null,"カーリルtoolbox: keichan")),a.createElement("main",null,a.createElement("div",{className:"left"},a.createElement("div",{className:"barcode active"},a.createElement(n,{large:!0,className:"tag"},"100014")),a.createElement("div",{className:"barcode"},a.createElement(n,{large:!0,className:"tag"},"100013"),a.createElement("p",null,"SPY×FAMILY 1")),a.createElement("div",{className:"barcode"},a.createElement(n,{large:!0,className:"tag"},"100012"),a.createElement("p",null,"1Q84 Book2"))),a.createElement("div",{className:"main"},a.createElement(l,{className:"card active",interactive:!0,elevation:c.TWO},a.createElement("div",null,a.createElement(n,{className:"tag",large:!0},"100014"),a.createElement(n,{className:"tag"},"管理バーコード")),a.createElement(s,{icon:"delete",size:25,color:"#ffffff"})),m?a.createElement("div",{className:"nextBook"},a.createElement("h2",null,"もしかして",a.createElement("span",null,"(",m.title+""+m.volume,"より推定)")),u.map((e=>a.createElement(l,{key:e.isbn,className:"card",interactive:!0,elevation:c.TWO},a.createElement("div",{className:"card-header"},a.createElement("h3",null,[e.title,e.volume].join(" ")),a.createElement("p",{className:"author"},e.author)),a.createElement(s,{icon:"add",size:25,color:"#ffffff"}))))):null)))};r.render(a.createElement(o,null),document.getElementById("app"));
