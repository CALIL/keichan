import("data:text/javascript;base64,Cg==");import{n as e}from"./normalize_isbn.2e27dccc.js";import{r as t,R as a,T as l,C as n,E as c,c as r,b as s}from"./vendor.8dec45df.js";const o=s=>{let o="",i=null;const[m,u]=t.exports.useState(null),[d,p]=t.exports.useState([]);t.exports.useEffect((()=>{window.document.addEventListener("keydown",E)}),[]),t.exports.useEffect((()=>{window.document.addEventListener("keydown",E)}),[]);const E=e=>{const t=e||window.event,a=t.keyCode||t.which||t.charCode;"Enter"===e.key||13===a?(h(),i&&clearTimeout(i),o=""):(1===e.key.length?o+=e.key:"Shift"===e.key||(o=""),i&&clearTimeout(i),i=setTimeout((()=>{console.log("clear"),h(),o=""}),300))},h=async()=>{const t=e(o);if(t){const e=await f(t);e&&(u(e),await b(e))}},f=async e=>{u(null),p([]);const t=await fetch(`https://unitrad.calil.jp/v1/search?isbn=${e}&region=recipe`).then((e=>e.json()));return t.count>=1?t.books[0]:null},b=async e=>{const t=e.title.split(/\s/)[0],a=`https://unitrad.calil.jp/v1/search?author=${encodeURIComponent(e.author.split(",")[0])}&publisher=${encodeURIComponent(e.publisher)}&year_start=${encodeURIComponent(e.pubdate)}&region=recipe`,l=await fetch(a).then((e=>e.json()));if(l.count>=1){let a=[];l.books.forEach((l=>{if(null===l.isbn)return;if(l.isbn===e.isbn)return;if(!l.title.match(t))return;let n=0;l.pubdate&&(n="string"!=typeof l.pubdate?l.pubdate:Number(l.pubdate.split("/")[0].split(".")[0])),a.push({title:l.title+" "+l.volume,author:l.author.split(",")[0],publisher:l.publisher,pubdate:n})})),p(a)}};return a.createElement("div",{id:"suggests"},a.createElement("header",null,a.createElement("h1",null,"カーリルtoolbox: keichan")),a.createElement("main",null,a.createElement("div",{className:"left"},a.createElement("div",{className:"barcode active"},a.createElement(l,{large:!0,className:"tag"},"100014")),a.createElement("div",{className:"barcode"},a.createElement(l,{large:!0,className:"tag"},"100013"),a.createElement("p",null,"SPY×FAMILY 1")),a.createElement("div",{className:"barcode"},a.createElement(l,{large:!0,className:"tag"},"100012"),a.createElement("p",null,"1Q84 Book2"))),a.createElement("div",{className:"main"},a.createElement(n,{className:"card active",interactive:!0,elevation:c.TWO},a.createElement("div",null,a.createElement(l,{className:"tag",large:!0},"100014"),a.createElement(l,{className:"tag"},"管理バーコード")),a.createElement(r,{icon:"delete",size:25,color:"#ffffff"})),m?a.createElement("div",{className:"nextBook"},a.createElement("h2",null,"もしかして",a.createElement("span",null,"(",m.title+""+m.volume,"より推定)")),d.map((e=>a.createElement(n,{key:e.isbn,className:"card",interactive:!0,elevation:c.TWO},a.createElement("div",{className:"card-header"},a.createElement("h3",null,[e.title,e.volume].join(" ")),a.createElement("p",{className:"author"},e.author)),a.createElement(r,{icon:"add",size:25,color:"#ffffff"}))))):null)))};s.render(a.createElement(o,null),document.getElementById("app"));
